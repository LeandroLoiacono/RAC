#:kivy 2.0.0
<RacXY>:
  cols: 3
  Button:
    id: ul_but
    on_press: app.move_relative(-1,1)
    canvas:
      Line:
        width: 2.
        circle: (self.center_x, self.center_y, min(self.width, self.height) / 4, 0, 360)
        bezier:
          (self.x, self.y, self.center_x, self.center_y)
  Button:
    id: u_but
    on_press: app.move_relative(0,1)
    canvas:
      Line:
        width: 2.
        circle: (self.center_x, self.center_y, min(self.width, self.height) / 4, 0, 360)
  Button:
    id: ur_but
    on_press: app.move_relative(1,1)
    canvas:
      Line:
        width: 2.
        circle: (self.center_x, self.center_y, min(self.width, self.height) / 4, 0, 360)
  Button:
    id: l_but
    on_press: app.move_relative(-1)
    Image:
      source: 'left.png'
      y: self.parent.y + self.parent.height / 2 - 25
      x: self.parent.x
      size: 50, 50
      allow_stretch: True
  Button:
    id: m_but
    text: 'HOME XY'
    on_press: app.home(1,1)
  Button:
    id: r_but
    on_press: app.move_relative(1)
    Image:
      source: 'right.png'
      y: self.parent.y + self.parent.height / 2 - 25
      x: self.parent.x + self.parent.width - 50
      size: 50, 50
      allow_stretch: True
  Button:
    id: dl_but
    on_press: app.move_relative(-1,-1)
    Image:
      source: 'left_down.png'
      y: self.parent.y
      x: self.parent.x
      size: 50, 50
      allow_stretch: True
  Button:
    id: d_but
    on_press: app.move_relative(0,-1)
    Image:
      source: 'down.png'
      y: self.parent.y
      x: self.parent.x + self.parent.width / 2 - 25
      size: 50, 50
      allow_stretch: True
  Button:
    id: dr_but
    on_press: app.move_relative(1,-1)
    Image:
      source: 'right_down.png'
      y: self.parent.y 
      x: self.parent.x + self.parent.width - 50
      size: 50, 50
      allow_stretch: True

<RacZ>:
  rows: 3
  Button:
    id: 'uz_but'
    text: 'UP'
    on_press: app.move_relative(0,0,1)
  Button:
    id: 'hz_but'
    text: 'HOME Z'
    on_press: app.home(0,0,1)
  Button:
    id: 'dz_but'
    text: 'DOWN'
    on_press: app.move_relative(0,0,-1)

<Rac>:
  orientation: 'lr-tb'
  Label:
    id: Header_lbl
    text: 'Robot Arm Controller'
    size_hint_x: 1
    size_hint_y: 0.1
  BoxLayout:
    size_hint_x: 0.5
    size_hint_y: 0.9
    orientation: 'vertical'
    spacing: 20
    BoxLayout:
      size_hint_y: 0.8
      orientation: 'horizontal'
      spacing: 50
      RacXY:
        size_hint_x: 0.8
      RacZ:
        size_hint_x: 0.2
    BoxLayout:
      orientation: 'horizontal'
      size_hint_y: 0.2
      Button:
        id: home_but
        text: 'HOME XYZ'
        on_press: app.home(1,1,1)
      ToggleButton:
        id: motors_tgl
        text: 'Motors Enabled'
        state: app.motorsToggleState
        on_press: app.toggleMotors(self)
      ToggleButton:
        id: grpper_tgl
        text: 'Toggle Gripper'
        #state: app.motorsToggleState
        on_press: app.toggleGripper(self)
      Spinner:
        id: step_spinner
        text: str(app.step)
        values: '0.1', '1', '10'
        on_text: app.setStep(self.text)
    Label:
      id: E_Axis_lbl
      text: 'E Axis'
      size_hint_y: 0.01
    Slider:
      id: e_slider
      min: 0
      max: 100
  BoxLayout:
    size_hint_x: 0.5
    size_hint_y: 1
    orientation: 'vertical'
    BoxLayout:
      orientation: 'horizontal'
      size_hint_y: 0.05
      Label:
        id: port_lbl
        text: 'COM Port'
        size_hint_x: 0.2
      Label:
        id: g_code_lbl
        text: 'Custom G-Code'
        size_hint_x: 0.8
    BoxLayout:
      orientation: 'horizontal'
      size_hint_y: 0.05
      Spinner:
        id: port_spinner
        text: str(app.port)
        values: (app.ports_available,) 
        on_text: app.setPort(self.text)
        size_hint_x: 0.2
      TextInput:
        id: gcode_txt
        multiline: False
        size_hint_x: 0.6
      Button:
        id: gcode_btn
        text: 'Send'
        size_hint_x: 0.2
        on_press: app.send_gcode(gcode_txt)
    Label:
      id: Console_lbl
      text: 'Console'
      size_hint_y: 0.05
    TextInput:
      id: Console_txt
      multiline: True
      size_hint_y: 0.5
      text: app.console
    #Label:
    #  id: GCode_lbl
    #  text: 'G-CODE'
    #FileChooserIconView:
    #  id: filechooser
